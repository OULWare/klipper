#
# This config is for RADDS + DUE!
#

[driver drv8825]
type:               default
steps_per_mm:       400

[driver tmc2130_x]
type:               TMC2130
#steps_per_mm:       400
steps_per_mm:       100
# SPI
ss_pin:             driverxy:ar7
spi_mode:           3
spi_speed:          2000000
# config
current:            1500.0
microsteps:         8
#microsteps:         32
mode :              spreadCycle
diag0_out:          temp_prewarn
diag1_out:          stall
diag0_active_high:  1
diag1_active_high:  1
interpolate:        0
sensor_less_homing: 1
stealth_max_speed:  40
stall_threshold:    19

[driver tmc2130_y]
type:               TMC2130
#steps_per_mm:       400
steps_per_mm:       100
# SPI
ss_pin:             driverxy:ar10
spi_mode:           3
spi_speed:          2000000
# config
current:            1500.0
#microsteps:         32
microsteps:         8
mode :              spreadCycle
diag0_out:          temp_prewarn
diag1_out:          stall
diag0_active_high:  1
diag1_active_high:  1
interpolate:        0
sensor_less_homing: 1
stealth_max_speed:  40
stall_threshold:    19


# The stepper_x section is used to describe the X axis as well as the
# stepper controlling the X+Y movement.
[stepper_x]
#driver:             drv8825
driver:             tmc2130_x

step_pin:           driverxy:ar2
dir_pin:            driverxy:ar3
enable_pin:         !driverxy:ar4
endstop_pin:        driverxy:ar6

position_min:       0
position_max:       200
position_endstop:   0
homing_offset:      0
homing_speed:       40
homing_direction:   min
homing_retract_dist:5

# The stepper_y section is used to describe the Y axis as well as the
# stepper controlling the X-Y movement.
[stepper_y]
#driver:             drv8825
driver:             tmc2130_y

step_pin:           driverxy:ar15
dir_pin:            driverxy:ar14
enable_pin:         !driverxy:ar19
endstop_pin:        driverxy:ar9

position_min:       0
position_max:       200
position_endstop:   0
homing_offset:      0
homing_speed:       40
homing_direction:   min
homing_retract_dist:5

[stepper_z]
steps_per_mm:       3200
step_pin:           ar2
dir_pin:            ar3
enable_pin:         !ar15
# min 32, max 38
endstop_pin:        ar32

position_min:       0
position_max:       200
position_endstop:   0.0
homing_pos_x:       100
homing_pos_y:       100
homing_offset:      1.5
homing_speed:       3
homing_direction:   min
homing_retract_dist:5
homing_retract_after: true

########################################
[SKIP_extruder0]
step_pin:           ar61
dir_pin:            ar60
enable_pin:         !ar62
steps_per_mm:       837
nozzle_diameter:    0.400
filament_diameter:  1.750
heater:             heater 0
min_extrude_temp:   170
#deactivate_gcode: ""
#activate_gcode: ""

[SKIP_extruder1]
step_pin:           ar64
dir_pin:            ar63
enable_pin:         !ar65
steps_per_mm:       837
nozzle_diameter:    0.400
filament_diameter:  1.750
heater:             heater 0
min_extrude_temp:   170

[SKIP_extruder2]
step_pin:           ar51
dir_pin:            ar53
enable_pin:         !ar49
steps_per_mm:       837
nozzle_diameter:    0.400
filament_diameter:  1.750
heater:             heater 0
min_extrude_temp:   170

########################################
[SKIP_heater 0]
heater_pin:         ar13
min_temp:           0
max_temp:           280
control:            pid
pid_Kp:             22.2
pid_Ki:             1.08
pid_Kd:             114
#*** Thermistor:
# analog0 or ar25
#sensor_pin:         analog0
#sensor_type:        NTC 100K beta 3950
#*** MAX31865 + PT100
sensor_pin:         ar57
sensor_type:        MAX31865
rtd_nominal_r:      100
rtd_num_of_wires:   2
#rtd_use_50Hz_filter: false
rtd_reference_r:    430
spi_mode:           1
spi_speed:          8000000
#*** Thermal protection
protect_period_heat:        20
protect_hysteresis_heat:    4
protect_period:             10
protect_hysteresis_runaway: 10

#[heater 1]
#heater_pin:         ar12
# analog1 or ar27
#sensor_pin:         ar27

#[heater 2]
#heater_pin:         ar11
# analog2 or ar29
#sensor_pin:         ar29

[heater bed]
heater_pin:         ar7
min_temp:           0
max_temp:           110
control:            pid
pid_Kp:             22.2
pid_Ki:             1.08
pid_Kd:             114
#*** Thermistor
sensor_pin:         analog4
sensor_type:        NTC 100K beta 3950
#*** Thermal protection
protect_period_heat:        20
protect_hysteresis_heat:    4
protect_period:             10
protect_hysteresis_runaway: 10

########################################
[fan 0]
pin:                ar9
max_power:          1.0
kick_start_time:    0.1
hard_pwm:           0

[heater_fan hotend]
pin:             ar8
max_power:       1.0
kick_start_time: 0.1
hard_pwm:        0
heater:          heater 0
heater_temp:     50.0
fan_speed:       1.0

########################################
[mcu]
serial:         /dev/ttyACM0 ; Due port
#serial:         /dev/ttyUSB0
#serial:         /dev/tty.usbmodemFD111
#serial:         /dev/tty.usbmodemFA131
baud:           115200
pin_map:        arduino
restart_method: arduino

[mcu driverxy]
#serial:         /dev/tty.wchusbserialfa130
#serial:         /dev/tty.wchusbserialfd110
serial:         /dev/ttyUSB0 ; Arduino Nano port
baud:           115200
pin_map:        arduino
restart_method: arduino

[printer]
name:           MyCoreXY
kinematics:     corexy
max_velocity:   300
max_accel:      3000
#max_accel_to_decel: 1500
max_z_velocity: 25
max_z_accel:    30
motor_off_time: 600
#junction_deviation: 0.02
require_home_after_motor_off: false
